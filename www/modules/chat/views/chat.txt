<?=HTML::style('css/miniSend.css')?>
<div id="mini_send">
    <div id="header">
        <span id="header-inner">Сообщение</span>
        <span class="pull-right arrow"><i class="icon-remove"></i></span>
        <span class="pull-right arrow"><i class="icon-minus-sign-alt"></i></span><!--icon-plus-sign-alt-->
    </div>
    <div id="inner">
        <div id="messages">
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
            <div id="message">
                <div class="avatar pull-left">
                    <?=HTML::image($userPhoto)?>
                </div>
                <div class="text">
                    sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd
                    <div class="clearfix"></div>
                    <div class="time pull-right">17:30:48</div>
                    <div class="clearfix"></div>
                </div>
            </div>
        </div>
        <div id="enter">
            <div class="avatar pull-left">
                <?=HTML::image($userPhoto, array('width' => '30px', 'height' => '30px'))?>
            </div>
            <div contenteditable="true" class="message" id="msg" title="Нажмите Enter для отправки сообщения и Shift+Enter для переноса">asdasd</div>
        </div>
    </div>
</div>
<script>
    $(function() {

        $('#messages').slimScroll({
            height: $("#messages").height(),
            alwaysVisible: true
//            start: 'bottom'
            //scrollBy: '100px'
        }).bind('slimscrolling', function(e, pos) {
                if (pos > 0) {
                    $('#messages').addClass('shadow');
                } else if(pos == 0) {
                    $('#messages').removeClass('shadow');
                }
            });

        $('#chat').on('click', function() {
            var element = $('#toggle');
            $('#mini_send').animate({marginBottom: 0},function(){
                if (element.hasClass('up')){
                    element.removeClass('up');
                }
                if (!(element.hasClass('down'))){
                    element.addClass('down');
                }
            });
        });
/*
        $('#msg').on('focus', function() {
            $('#enter').addClass('shadow');
        });
        $('#msg').on('focusout', function() {
            $('#enter').removeClass('shadow');
        });*/

/*        $('#msg').on('keypress', function(e) {
            if ((e.which == 13) && e.shiftKey) {} // перенос строки
            if (e.which == 13 && !e.shiftKey) { // отправка сообщения
                e.preventDefault();
        $('#messages').append(
            '<div id="message">' +
                '<div class="time pull-right">17:30:48</div>' +
                '<div class="avatar pull-left">' +
                    '<img src="https://lh5.googleusercontent.com/-sUhzn4o5Wc4/AAAAAAAAAAI/AAAAAAAAFuI/3UlHj3ZH2NA/photo.jpg">' +
                '</div>' +
                '<div class="text pull-left">' +
                    'sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd' +
                '</div>' +
                '<div class="clearfix"></div>' +
            '</div>'
        ).slimScroll();
                $('#messages').append('<div id="message">' +
                    '<div class="avatar pull-left">' +
                    '<img src="https://lh5.googleusercontent.com/-sUhzn4o5Wc4/AAAAAAAAAAI/AAAAAAAAFuI/3UlHj3ZH2NA/photo.jpg" width="30px" height="30px">' +
                    '</div>' +
                    '<div class="text">' +
                    'sdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfdsdfsdfsdfd' +
                    '</div>' +
                    '</div>').slimScroll({ scrollBy: '50px' });//.slimScroll({ scrollBy: '60px' });
                //alert('При нажатии на enter будет отправка');
                return false;
            }
        });*/

    });
</script>